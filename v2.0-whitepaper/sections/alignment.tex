\section{Alignment and calibration of detectors}

Accurate alignment and calibration of detectors are crucial to the quality of event reconstruction, ensuring faithful decoding of raw detector information to reconstructible objects. This is particularly important for offline-quality reconstruction, where the final reconstructed objects are later used in physics analysis. Alignment and calibration are typically implemented together %(where alignment often refers to tracking subdetectors and calibration to non-tracking subdetectors, e.g., calorimeters),
performing a minimisation of parameters describing the physical offsets experienced in a given subdetector, e.g., residuals between the expected position of a track and the measured position. Alignment and calibration techniques are also applied online when partial reconstructions and trigger decisions require more accurate knowledge of an object. The real-time approaches of LHCb and ALICE in Run~3 typify this and are thus the focus of this chapter. At ATLAS and CMS, the complex detector nature prevents full alignment and calibration in real time.

% LHCb
%\subsection{Real-time detector alignment in LHCb}
To enable the use of real-time alignment and calibration of the LHCb detector the trigger system was designed with a large timing budget between HLT stages, provided by a disk buffer of 30 PB. The online LHCb calibration ensures offline-quality reconstruction, enabling trigger selection with high signal efficiencies. This calibration is typically separated into the alignment of the VELO, UT/SciFi, muon stations and RICH mirrors, and the calibration of the ECAL and RICH. A dedicated data sample\footnote{In addition to triggers which select events for offline analysis at LHCb, dedicated triggers which select events required for alignment and calibration purposes are employed. Events selected by the latter are saved into a dedicated stream described in Section~\ref{sec:data}.} is collected, from which the alignment framework calculates updated alignment constants at regular intervals, i.e., per fill or run, as soon as sufficient data has been collected for precise calculation of the constants.

The alignment constants for the tracking detectors are determined by minimising track reconstruction parameters with respect to the degrees of freedom of each alignable detector element, i.e., translations and rotations in each spatial dimension~\cite{LHCb:wouter-kf}. The UT and SciFi are also aligned using reconstructed tracks traversing the entire tracking system to achieve high track-momentum resolution \cite{Reiss:2846414}. The ECAL is calibrated by analysing a specific mass distribution in each ECAL cell, providing a mass shift from the known position which can be applied as an adjustment of the photomultiplier tubes after each fill. The RICH is aligned and calibrated on a per-run basis, comparing the distribution of hits and Cherenkov angles to anticipated distributions to generate alignment and calibration constants~\cite{LHCb:RICH_AlignCalib}.
%the $\pi^0\rightarrow \gamma\gamma$ 

% ALICE
%\subsection{Real-time TPC alignment in ALICE}
At ALICE, as a consequence of upgrades for continuous readout in Run~3, the TPC requires real-time calibration to correct for space-charge density distortions which are particularly problematic in high pile-up scenarios. Fluctuations in space-charge distortions vary on a scale of \SI{10}{\milli\second} and need to be corrected for. Average space-charge distortions are corrected with the aid of relevant subdetectors; however, the calibration of average space-charge distortions requires $\mathcal{O}\left(\mathrm{minutes}\right)$ of data collection to form a reliable correction map. Convolutional neural networks (CNNs) are employed to predict the fast-varying fluctuations in space-charge distortion, obtaining a reliable calibration at the fluctuation timescale. The CNN models run on GPUs directly in the HLT farm, resulting in a significant speedup of the TPC calibration.
